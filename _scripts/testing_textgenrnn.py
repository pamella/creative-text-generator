# -*- coding: utf-8 -*-
"""Teste de output com Textgenrnn.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Zojk9SNVbumQZ_GpCJfQGro5n4fs35N3

# Criative text generator
Área: Texto | Grupo: 9
"""

# Commented out IPython magic to ensure Python compatibility.
# %tensorflow_version 1.x

from google.colab import drive
drive.mount('/content/drive')

!pip install -q textgenrnn
from google.colab import files
from textgenrnn import textgenrnn
from datetime import datetime
import os

"""Faça o upload do seu arquivo de entrada para o colab

![2020-09-26 22.59.59.jpg](data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAVAAAACtCAIAAABp8bD9AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAW90lEQVR4nO3df1ATd/oH8AcUKOGI0ITzakjkKpbod2rA2koGW727aoUrclW8Gu7iCdE5ZxS00zMBz6n2aoXEMvSIVmYgcpaRvWkZp6GenNg5f9BciqfQKO0FoQwuchUJIiKJWCnfPxZCIAE3QH6QfV7jOMlms/tshnc+n/3sZtdvcHAQEELM4O/pAhBC7jO7qanJ0zUghNzED7v0CDEHdukRYhAMPEIMgoFHiEEw8AgxCAYeIQbBwCPEIBh4hBgEA48Qg2DgEWIQDDxCDIKBR4hBMPAIMQgGHiEGwcAjxCAYeIQYBAOPEINg4BHyUiRJqlQqs9k83gxms1mlUpEkSX+ZGHiEvBRBEEajcbzMU2k3Go0EQdBfJgYeIS+VmZnJ5/MdtvPWtp3P52dmZtJfJgYeIS/FYrEUCoV95m3TrlAoWCwW/WXiRSwR8mpms1mpVLa1tQkEArlcDgCTTjvMlMAPDg6SJMlms8PDwz1dC0LuZpt5AJh02oF+4NVqdVtbm1wuN5lMjY2NE8zJ5XITEhKcrYOiUqmKiopsp/B4vNLSUovFsnnz5tjY2MLCwo6OjvT09KysrI0bN05uLQjNONbMA8Ck0w4As2nOZzQaLRYLlXatVjvBnDExMZMOPADMnTt33bp1wcHB1NOgoKDQ0NCgoCAejzd//vygoKBJLxmhGc3Pz2/Mg0mgG3iFQtHW1iYUCoVCYUpKyqTX90TPPPPM9u3b7bvup0+fdt1KEfJmtqN0MHx8Xi6XT6KRpztKLxAIptJuT1F3d/f69etVKpX9SyRJ7tq1a9GiRYsWLZLJZNeuXaN2UgYHBy9durRu3bpnn302Li7u4MGD3d3dbi8coakaMybvcNyePrqBN5vNJpPJ2aVPwvfff19UVPThsLNnz04wc1NTU3p6ekhICEEQBEHMmzdPJpNdvnwZABoaGnbt2jVv3jyNRpOVlfX5558XFBT09/e7YRMQmi72R+DGO1ZHE90u/f79+7u6ug4cONDW1qbT6SaYk8/nSyQSp4qw1dHRUVxcbH26ffv21157zeGcjx49KikpWbhw4c6dO6l9/j/+8Y8kSWq12qVLl5rN5p6enjfeeGPVqlV+fn5vvPEGm83298fzDtCMMd7xdirzSqVyEn17uoFnsVhdXV3UY5ceyYuNjdVoNHQOv/X29hqNxuvXr1dXV49ZwoMHD55//vmMjIzMzMzo6OhVq1YlJyez2WyXVY3Q9FOr1eMdgbPNvFqtVigUNJfpxKCd2Wzmcrme3Zm3t23btuzsbIfjlvv27du5c2dDQ8O//vWv9evXb9my5a233goMDHR/kQhNgkQiIQgiMzPTYQNOZV6tVjvVoabbxWWxWFwul/5y3SA0NFQoFH7xxRfW8wIePHhQVFR048aNwcHB+vr6ffv2WSyWFStWvPPOOzt27Dh9+rRTvytCyLMEAsHEx9upzFNn49BEt4UnSbKtrc2r2vbAwECJRHLhwgWJRPL6668HBQVVVVWZzeYlS5Y899xzFovlH//4x/nz5xMTE/v7+0+fPr1kyRJv+85CyM3oBl6pVFosFg6HQ+fEG/p7FFMUGxv76aef5ufnV1RUAMAvfvGLnTt3Ll68GADEYnFxcXFBQcHHH38cEhKSmJi4Y8eOsLAw9xSGkHeie2qtRqMxGo0KhcKlp9YihFxqZvx4BiE0LfC4NEIMgoFHiEEw8AgxCAYeIQbBwCPEIBh4hBgEA48Qg2DgEWIQDDxCDIKBR4hBMPAIMQgGHiEGwcAjxCAYeIQYBAOPEINg4BFiEAw8QgyCgUeIQTDwCDEI3avWeqGvvvpKLpffunXL4aupqakObz6JEJPN4ItYvvzyy+3t7RPMgJlHaIwZ3MJTaW9pabF/6dlnnwUA6mL1Lsp8XV1dZWWl/a1sEhISZDKZK9bo/ZUg7zeDA0+H6zJPEIT17pq2qFvrujNp3lMJ8n4+HnhwWeYdZoyi0+nGu6M2l8vdtGnT0qVLfbIS5P0YMUpfUVEhl8s9XQUAgMlkqqysdPNK+Xx+TExMTEwMh8PxbCXI43y/hadUVFS4omN//Phxp+bPyMhw/x1sZTIZdYNRk8lk+8WH99JlIN9s4VtG83Q5npSSknLu3DnqMZfLXb16tWfrQZ7lm4FHFA6Hk5KSIhAIjEYjNSUlJSU4ONizVSEP8rXAe8/uukPHjx93di9gKqgh+tWrV9fX11NTWCzWmjVr3FYA8jY+tQ9vTbtQKMzIyPB0OQAAJEnW19c3NjayWKyYmJiEhAS1Wg0ACoXC1auOi4sTCoXUYy6Xq9PpqNt4p6SkfPnllxOM7SMf5juBt23bDx48yGazU1NTPVvSuXPnCIIAAD6f39fXV1dXR+1O246Wu45EIrE+rq6u9vPzi4uLY7FY1EtHjhxxQw3I2/hI4O178tRTD2beZDIRBMHn86lBcpPJVF9fr9VqzWazGwKfkpLC5XKpx1qtlmrPVSoVFXjEWD4S+NraWgBQqVRUzqkHtbW1Hgw8dcZLZmYmFTydTqfVat22dqr3DgBms9lsNtsPHNTV1WEjz0A+EvjDhw9v2LAhPj7e2rBHRkbGx8d7sCSj0RgTE2NtZhMSEmJiYqjHbmhmdTpdSkoKAGi1WuqB/QyurgF5IadH6c1ms31LRfVUp6mkSRoTb8+m3R6XyxUOo06DcSmtVmsymUiSZLFY9t8vRqPROm6PGMW5Ft5sNqtUKpIkY2JirCPARqNRq9XW19fL5XLm7CJyOJyurq7xjgXI5XJqYNxkMlkbeQAwGo0qlUoikUzjCTBUJfbTqTMLWSxWY2PjmJeoc+z4fP501YBmCidaeGvaZTKZNe0AIBQKZTIZSZIqlcrj7bzbTq2TSCQTBKayspKK9JEjR0wmEzWRJMm///3vABAXF+eGSkwmE9XIG+1QA4cOu/rIt9G9AIZt2q0DQrZ0Op1GoxEIBG5r50UiUW9vL82ZeTxeTU2NS+uxZz0sR30/Uqe7jfcBIuQGsw4cOPDEmZ6YdgAQCARcLvfChQsNDQ0vvfRSQEDANFdqJy4u7quvvqKTeR6Pd/jw4cjISFeXNMaCBQsSEhK4XO73338PAEKhUCKR4C9SkQfR3YenfyUst10zKz4+3v2NtrOo36vgT1aQl6C1D89isRQKBZ/P12g04x3Oobr0fD5foVAwZ+gOoZmF7qDdxJnHtCM0IzgxSm+beevPLQHAaDRi2hGaEZy+TLXZbD537tyYIzparXb16tUzJe1fX/vG0yWgaRO75P88XcJMMoOvSz9pX1/7Js3ml2Ro5ionCAy8U3ztAhgIoQlg4BFiEAw8QgyCgUeIQbzo9/BNTU2eLgHNPPhns3DhQvoze1Hgnap7KvCwnC9x25+Nb8AuvS3pISJXOvJUrCgpUYjHnzuXOCQd99WJibNLirPHX7SribOLR20pYgoMvPd4wvfLdNLnbZPklE3PstxYNpoyDDxCDOJF+/DeTJpLLPr2DCQlRQFAn0G9NU8/6nWxoiRLFAIAAK1n0nLKAECcXZI5PKlqqDmVHiKSogAAWg2GMWsYXkIWUb7uTFpOGUhzy6l5oc9QuFWpdzQzQOsZyd4yR1Osb6eqHfNUnF0sg+Nb8/QA0lwicXg91HaJs0sy4GJzdJIoxOHGWreiz1CoAdmTyhZnF8uguVMkimqtklTOs/ugRt7SajBERIOG2lj7bUTTAANPV1TS4iqJZC+ANJfIyBbrR1IgVpRkRTcXpuXpAUCaSxRnN2/L0+vztlJziLNLMrLFZXmgKEmKMFCzSQ8RSTAq83rlVlCUyIb+3KW55UlQJZFQ3xzFWblSvU0PXLpO1HkmbWuZTQEy0EjS9DA0DFFWOW9lhKFQMvw1IVaMejpCmkskwpk0yfA31PB6QkQroVCSphcrSrKSpaC3yZs4e+XwVlCF0yg7RDTnoiQtBwAAhj8VRYlMIS5TQnZx0nBt0tzyoU/FfoumaweE6bBLT1frmaG/ubJKA0SvtNlpjZ4DhuPDAbB5VXqIIMoJIlMUEjInevRsZZ8b+iZYl5gXYV0d6PMutUYtsh1ha+7pi0qyGfOLnhMSIsoiygminEiKgoh5Yv3/OkNEWdZhuTFPR9YzL6K1amQ9F1ujFlPz9Bk0Sj0A6C8190XwRu2g69s7Q0RZDkcrxy27z/C5Na/S3HKCKCeyrJ9KSOvFoW+issrhT8V+iyb4tJATsIW31dzTt3KeGMCuJXSe9BCxsqdQkkY1XIsBxLyIqS+Vos/bpgdxdkk5kTXc3bXuNVjnkZRR3zh9BvXWvLKcUU+ntH1lOWllIM0lygn7fY0nkeaWr+xRSyTUrsQiADEvoq+n2dGsdluEpgO28Lb0/+sMEa0barzE2TIRNF8a/oMebvxAuk4EzRdt/s6be0CUMdzeDr0q5kVA5//0AADSxVEAAPqLzSBKHl5G8tCO7Dh1tHdGJeVa63glqvW/dn/7+rytaWeoJrm5py/qFQcH+cr2SgoNEP2K2OFTanujEkfWszKq9VuaGSvLkajHdHRolC3mRUBnO/WpLIoCGPpU1o18skOfynhbhKYKW/hRynIK55VklRNJAADQWiUZaQxbYXE5QQAAtJ5JG9VG6pVbow8RWeVEls2r+kvriESCSARobW0dmk2zsjiLKE8CgFaDoc+uwddfapZlDo1+5ah5JZkEkQhAjX6NCs7IwFhrlaQMAEYV0GdQb734yvCIV5+hcJt+ZACsz1C4TQ8wHKVR29tnUG99ct5HBiP7DOqtegCgWzaAPu9iMpFUTiTZfCp5x1cOv2XkU9HbbdHUeiVoGP4enhZpLrHoWxwrdjXpIWLxf53pyePv4Z2FXXrkLZzap0CTg1165FnWo/p09ynQVPhO4HU63ZjL6fL5fMk0XcqqLAcvieUiZXslGHL38ZHAkySp0WjGTKRuoiaTyTxSEkJeyEHgr+4Mph68cMTi3mImb7ybWNo3+wCQtftt11eEkDfy2UE7Dofj6RIQ8jo+0qUfIyEhQSaTTXBjrKEj6ggxjA8Gnko7AFD/22e+8MN8AJDL5bZ3uUeICXytS29NOwVvxo6QLZ8KvEAgWLFiBUmS1ikkSa5YsUIgEHiwKoS8h08FniRJpVJJ2OyfEwShVCptvwImNjAwcOXKldu3bwPAw4cP//3vf9+/f98ltSLkCT4V+Kkzm83Hjh27fPkyAJhMpry8vOZmhz/eRGhG8sFBu6kIDQ21nsATGRlZWVnp2XoQml4+GPi2tjaVSmV97NliEPIqPhJ421vTm81mo9Ho1FsQYggfCbxAIJDJZHV1deOdY2uLxWIlJCTg0D1iIAcXwJiJ59IjhOig28I/6rrZf3fUwS1W5POzgsNcUBJCyFVoBf5R183r+8eehcqKFD2365+YeYRmEFqBN9U6uESB+Zbh27z4oKfnj5keHLmEv+HwNJSGEJpuTgzaBfOWzGbNsZs8agjgsbnnzvkjoQtfCVuSPOXaEELTzInA81MPhy58ZeJ5epsu3fjra+ZbBgw8Ql4IT61FiEEw8AgxCAYeIQbBwHtGd3f3+vXra2trJ72E2tra3bt3Wyx4chRygo+cWgsuvi79TNTc3Lxnz57Dhw9HR0d7uhbkLXwk8HhdeoTocCLwlvZrAH405pmSO3fu/PSnP3X2XU5dlx4AhEKhXC53+JaWlpZ3331Xr9fz+fzdu3f/+te/9vf3f/jw4d/+9rfS0tL79++vXbt23759HA6nubn54MGDq1atKi4uvnv37ubNm3/3u9/l5+dXVVUtWLDgvffeW7ZsWXd399tvv/3LX/7y5MmT33333W9+85ucnJzw8HDbNQ4ODp47d66goOC7775LTEzcu3fv3LlzHdbW1dX1l7/8paqq6sUXX7S9Vl97e7tKpaqurmaz2du3b9+8efOpU6cUCgUArFmzRqlUbty40eEm0Px4kc+gtQ/PXS4FgLaKPTf+umbif20Ve6zzT05FRUVHR8ek306T0Wh0+BPa3t7e999/PzEx8ZtvviksLDx27NjXX38NAB9//PGNGzfOnj1rMBj4fH5RUdHAwAAAtLa2+vn5VVdXV1ZW1tTU7NixQyqVXr9+ffPmzWq1mro81r1799ra2giCqKmp6e/v/+ijj6j3WtXU1Jw8ebK4uPjatWsikSg3N9fhnvmjR48KCgp+9rOfXbly5YMPPmhsbLTW/M4774jF4oaGhs8+++yLL7748ssvN27cWF1dLRKJqqurN27cOMEmIEah1cIHcuY//66x/+5NOjMHPT0/kDP2fFunfPjhh7t37x6vlXOpx48f9/f3L168OCAgQCgUKpXKsLCwwcHBTZs2BQQEBAcHA0BCQsIHH3zQ29sLAFFRUa+//npISEh0dPTLL78MAC+88IKfn9+LL774ySef3Llzh8PhsNns1NTUsLAwAPjDH/5w8ODBzs7OoKAgao0Wi+XUqVNbtmyJjIwEgKSkpAsXLty+ffvnP//5mNpIkmxsbMzPz2ez2Ww2+8033/zkk08AgMVi5efnh4aGzpo165lnnhGJRFevXl25cqXte8fbBKoqxBx0u/SBnKnGmL6Ojg5PZZ7NZv/qV7/atm1bYmLiq6++umzZsqeeegoAZs+efeLEidLS0s7OTgCIjY2lflbs7+/v7+8PAH5+frNmzaIejFmmv7+/deL8+fPZbPaDBw+sgX/48CFJkrYDDTwez2Hb29XVFRwcbI0otTrqwf379/fv319dXd3f3w8A27dvH/NePz+/8TYBMYqXHpajMu+Gvv0Ys2bNSk9PP3369PLly0tLS3//+9/fvHlzYGCgqKjoxo0bVVVVLS0txBTuWvPDDz88fvx4zMTAwMBTp061DKupqXFqXL2zs1OhUMTHx1+7dq2lpcU+7QAwjZuAZjQvDbyn3L1798qVK3PmzElMTDx27NiCBQsuX7786NEjkiTffPPNp59+GgCmsuvb1dX1ww8//OQnP7FOCQoKCg8Pb2hooJ4ODg7++OOPDt/L4XAsFsu9e/eop9Yyenp6goOD165dGxAQMDg46LC8adwENKN5aeDnzp3rkS79gwcP3n///fPnz//4448dHR03b95ks9mzZ89ms9nV1dV3795tamo6evSoU8u8d+/ep59+2tvbe+/ePY1Gs3z58oiICOurLBYrOTn5xIkTdXV1AwMDV69e/dOf/tTd3W2/HIFAEBMTc/Lkyfv379+6devEiRPU9Keeeqq7u1un0/X19Z09e/azzz6jpoeHh8+ePburq6u/v3+Km4B8hjcG3lNpBwCBQPDee++Vl5cLhcJNmzYlJye/+uqrAQEBu3btMplM8fHxBw4cSEpKCggIoPaW6WCz2eHh4b/97W9feuml0NDQ9PR06+43Ze3atVlZWXv27Fm4cGFBQUFGRsaY43aUwMDAt9566/bt28uWLVMoFCKRiJoeGRn55z//+ejRo8uWLfvPf/6zYcMGi8UyMDAQFhaWlJS0ZcuWo0ePTnETkM/wumvaffTRRxs2bHA27Uaj0XppaprcczNJ6jj83r17ndotb25uTk9Pb29vt07h8XilpaV4zhyaIq870y41NXUSJ974mOjo6JqaGk9XgXyQ13XpJ5f2SVxkHq9LjxjI67r0k6bT6Zy6Lv3SpUvdUBVCXsV3Ao8QeiKv69IjhFwHA48Qg2DgEWIQB/vwCCFfhS08QgyCgUeIQTDwCDEIBh4hBsHAI8QgGHiEGAQDjxCDYOARYhAMPEIMgoFHiEEw8AgxCAYeIQbBwCPEIBh4hBgEA48Qg2DgEWIQDDxCDIKBR4hBMPAIMQgGHiEGwcAjxCAYeIQYBAOPEINg4BFiEAw8QgyCgUeIQTDwCDEIBh4hBvl/I4KiHPaY9WEAAAAASUVORK5CYII=)
"""

file_name = "beyonce-rihanna.txt"
model_name = "beyonceRihanna"

"""Sugerimos que você altere as configurações para analisar os diferentes resultados, até que você ache alguma saída satisfatória."""

model_cfg = {
    'word_level': False,        # set to True if want to train a word-level model (requires more data and smaller max_length)
    'rnn_size': 128,            # number of LSTM cells of each layer (128/256 recommended)
    'rnn_layers': 3,            # number of LSTM layers (>=2 recommended)
    'rnn_bidirectional': False, # consider text both forwards and backward, can give a training boost
    'max_length': 5,           # number of tokens to consider before predicting the next (20-40 for characters, 5-10 for words recommended)
    'max_words': 10000,         # maximum number of words to model; the rest will be ignored (word-level model only)
}

train_cfg = {
    'line_delimited': False,    # set to True if each text has its own line in the source file
    'num_epochs': 10,           # set higher to train the model for longer
    'gen_epochs': 5,            # generates sample text from model after given number of epochs
    'train_size': 0.8,          # proportion of input data to train on: setting < 1.0 limits model from learning perfectly
    'dropout': 0.0,             # ignore a random proportion of source tokens each epoch, allowing model to generalize better
    'validation': False,        # If train__size < 1.0, test on holdout dataset; will make overall training slower
    'is_csv': False             # set to True if file is a CSV exported from Excel/BigQuery/pandas
}

"""Agora o treinamento será feito de fato."""

# Pay attention to the "model_name", you can be using a model trained previously.
# If you want to reset the current model, execute texgen.reset()
# If you want a new model instance, change the "model_name"

textgen = textgenrnn(name=model_name)

train_function = textgen.train_from_file if train_cfg['line_delimited'] else textgen.train_from_largetext_file

train_function(
    file_path=file_name,
    new_model=True,
    num_epochs=train_cfg['num_epochs'],
    gen_epochs=train_cfg['gen_epochs'],
    batch_size=1024,
    train_size=train_cfg['train_size'],
    dropout=train_cfg['dropout'],
    validation=train_cfg['validation'],
    is_csv=train_cfg['is_csv'],
    rnn_layers=model_cfg['rnn_layers'],
    rnn_size=model_cfg['rnn_size'],
    rnn_bidirectional=model_cfg['rnn_bidirectional'],
    max_length=model_cfg['max_length'],
    dim_embeddings=100,
    word_level=model_cfg['word_level'])

"""Para gerar textos a partir do model que você treinou acima, você pode rodar a célula abaixo."""

# this temperature schedule cycles between 1 very unexpected token, 1 unexpected token, 2 expected tokens, repeat.
# changing the temperature schedule can result in wildly different output!
temperature = [1.0, 0.5, 0.2, 0.2]
prefix = None   # if you want each generated text to start with a given seed text

if train_cfg['line_delimited']:
  n = 1000
  max_gen_length = 60 if model_cfg['word_level'] else 300
else:
  n = 1
  max_gen_length = 2000 if model_cfg['word_level'] else 10000

timestring = datetime.now().strftime('%Y%m%d_%H%M%S')
gen_file = '{}_gentext_{}.txt'.format(model_name, timestring)

textgen.generate_to_file(gen_file,
                         temperature=temperature,
                         prefix=prefix,
                         n=n,
                         max_gen_length=max_gen_length)
files.download(gen_file)

textgen2 = textgenrnn()
textgen2.train_from_file('Rihanna.txt', num_epochs=1)
textgen2.generate()

"""## Material de referência

* [Github do textgenrnn](https://github.com/minimaxir/textgenrnn/)

* [PyPI do textgenrnn](https://pypi.org/project/textgenrnn/)
"""
